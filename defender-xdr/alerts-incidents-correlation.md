---
title: Overview 2: Alert correlation and incident merging in the Microsoft Defender portal
description: Learn how alerts are correlated, and how and why incidents may be merged, in the Microsoft Defender portal.
ms.service: defender-xdr
f1.keywords: 
  - NOCSH
ms.author: yelevin
author: yelevin
ms.localizationpriority: medium
manager: dansimp
audience: ITPro
ms.collection: 
  - m365-security
  - usx-security
  - tier1
  - sentinel-only
ms.topic: conceptual
search.appverid: 
  - MOE150
  - MET150
ms.date: 10/25/2024
appliesto: 
- Microsoft Defender XDR 
- Microsoft Sentinel in the Microsoft Defender portal
---

# Overview 2: Alert correlation and incident merging in the Microsoft Defender portal

This article continues your introduction to how alerts and incidents work, and what they represent, in the Microsoft Defender portal. For the beginning of this introduction, see [Incidents and alerts in the Microsoft Defender portal: an overview](/unified-secops-platform/incidents-alerts-overview).

## Incident creation and alert correlation

When alerts are generated by the various detection mechanisms in the Microsoft Defender portal, as described in the previous article, Defender places them into new or existing incidents according to the following logic:

| Scenario | Decision |
| -------- | -------- |
| The alert is sufficiently unique across all alert sources within a particular time frame. | Defender creates a new incident and adds the alert to it. |
| The alert is sufficiently related to other alerts&mdash;from the same source or across sources&mdash;within a particular time frame. | Defender adds the alert to an existing incident. |

The criteria used by the Defender portal to correlate alerts together in a single incident are part of its proprietary, internal correlation logic. This logic is also responsible for giving an appropriate name to the new incident.

## Incident correlation and merging

The Defender portal's correlation activities don't stop when incidents are created. Defender continues to detect commonalities and relationships between incidents, and between alerts across incidents. When two or more incidents are determined to be sufficiently alike, Defender merges the incidents into a single incident.

### How does Defender make that determination?

Defender's correlation engine merges incidents when it recognizes common elements between alerts in separate incidents, based on its deep knowledge of the data and the attack behavior. Some of these elements include:

- Entities&mdash;assets like users, devices, mailboxes, and others
- Artifacts&mdash;files, processes, email senders, and others
- Time frames
- Sequences of events that point to multistage attacks&mdash;for example, a malicious email click event that follows closely on a phishing email detection.

### When are incidents *not* merged?

Even when the correlation logic indicates that two incidents should be merged, Defender doesn't merge the incidents under the following circumstances:

- One of the incidents has a status of "Closed". Incidents that are resolved don't get reopened.
- The two incidents eligible for merging are assigned to two different people.
- Merging the two incidents would raise the number of entities in the merged incident above the allowed maximum of 50 entities per incident.
- The two incidents contain devices in different [device groups](/defender-endpoint/machine-groups) as defined by the organization. <br>(This condition is not in effect by default; it must be enabled.)

### What happens when incidents are merged?

When two or more incidents are merged, a new incident is not created to absorb them. Instead, the contents of one incident are migrated into the other incident, and the incident abandoned in the process is automatically closed. The abandoned incident is no longer visible or available in the Defender portal, and any reference to it is redirected to the consolidated incident. The abandoned, closed incident remains accessible in Microsoft Sentinel in the Azure portal. The contents of the incidents are handled in the following ways:

- Alerts contained in the abandoned incident are removed from it and added to the consolidated incident.
- Any tags applied to the abandoned incident are removed from it and added to the consolidated incident.
- A **`Redirected`** tag is added to the abandoned incident.
- Entities (assets etc.) follow the alerts they're linked to.
- Analytics rules recorded as involved in the creation of the abandoned incident are added to the rules recorded in the consolidated incident.
- Currently, comments and activity log entries in the abandoned incident are *not* moved to the consolidated incident.

To see the abandoned incident's comments and activity history, open the incident in Microsoft Sentinel in the Azure portal. The activity history includes the closing of the incident and the adding and removal of alerts, tags, and other items related to the incident merge. These activities are attributed to the identity *Microsoft Defender XDR - alert correlation*.

## Manual correlation

While Microsoft Defender already uses advanced correlation mechanisms, you might want to decide differently whether a given alert belongs with a particular incident or not. In such a case, you can unlink an alert from one incident and link it to another. Every alert must belong to an incident, so you can either link the alert to another existing incident, or to a new incident that you create on the spot.

[!INCLUDE [Microsoft Defender XDR rebranding](../includes/defender-m3d-techcommunity.md)]

## Next steps

Read more about incidents, investigation, and response: [Incident response in the Microsoft Defender portal](incidents-overview.md)

## See also

- [The power of incidents in Microsoft Defender XDR](https://techcommunity.microsoft.com/t5/microsoft-defender-xdr-blog/the-power-of-incidents-in-microsoft-365-defender/ba-p/3515483)
- [Inside Microsoft Defender XDR: Correlating and consolidating attacks into incidents](https://www.microsoft.com/en-us/security/blog/2020/07/09/inside-microsoft-threat-protection-correlating-and-consolidating-attacks-into-incidents/)
